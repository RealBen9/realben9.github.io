(function(t){function e(e){for(var i,o,r=e[0],l=e[1],c=e[2],h=0,d=[];h<r.length;h++)o=r[h],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&d.push(n[o][0]),n[o]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i]);u&&u(e);while(d.length)d.shift()();return a.push.apply(a,c||[]),s()}function s(){for(var t,e=0;e<a.length;e++){for(var s=a[e],i=!0,o=1;o<s.length;o++){var r=s[o];0!==n[r]&&(i=!1)}i&&(a.splice(e--,1),t=l(l.s=s[0]))}return t}var i={},o={app:0},n={app:0},a=[];function r(t){return l.p+"js/"+({}[t]||t)+"."+{"chunk-56a3ad15":"a1eb2e38"}[t]+".js"}function l(e){if(i[e])return i[e].exports;var s=i[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,l),s.l=!0,s.exports}l.e=function(t){var e=[],s={"chunk-56a3ad15":1};o[t]?e.push(o[t]):0!==o[t]&&s[t]&&e.push(o[t]=new Promise((function(e,s){for(var i="css/"+({}[t]||t)+"."+{"chunk-56a3ad15":"38a28738"}[t]+".css",n=l.p+i,a=document.getElementsByTagName("link"),r=0;r<a.length;r++){var c=a[r],h=c.getAttribute("data-href")||c.getAttribute("href");if("stylesheet"===c.rel&&(h===i||h===n))return e()}var d=document.getElementsByTagName("style");for(r=0;r<d.length;r++){c=d[r],h=c.getAttribute("data-href");if(h===i||h===n)return e()}var u=document.createElement("link");u.rel="stylesheet",u.type="text/css",u.onload=e,u.onerror=function(e){var i=e&&e.target&&e.target.src||n,a=new Error("Loading CSS chunk "+t+" failed.\n("+i+")");a.code="CSS_CHUNK_LOAD_FAILED",a.request=i,delete o[t],u.parentNode.removeChild(u),s(a)},u.href=n;var m=document.getElementsByTagName("head")[0];m.appendChild(u)})).then((function(){o[t]=0})));var i=n[t];if(0!==i)if(i)e.push(i[2]);else{var a=new Promise((function(e,s){i=n[t]=[e,s]}));e.push(i[2]=a);var c,h=document.createElement("script");h.charset="utf-8",h.timeout=120,l.nc&&h.setAttribute("nonce",l.nc),h.src=r(t);var d=new Error;c=function(e){h.onerror=h.onload=null,clearTimeout(u);var s=n[t];if(0!==s){if(s){var i=e&&("load"===e.type?"missing":e.type),o=e&&e.target&&e.target.src;d.message="Loading chunk "+t+" failed.\n("+i+": "+o+")",d.name="ChunkLoadError",d.type=i,d.request=o,s[1](d)}n[t]=void 0}};var u=setTimeout((function(){c({type:"timeout",target:h})}),12e4);h.onerror=h.onload=c,document.head.appendChild(h)}return Promise.all(e)},l.m=t,l.c=i,l.d=function(t,e,s){l.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},l.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},l.t=function(t,e){if(1&e&&(t=l(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(l.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)l.d(s,i,function(e){return t[e]}.bind(null,i));return s},l.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return l.d(e,"a",e),e},l.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},l.p="",l.oe=function(t){throw console.error(t),t};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],h=c.push.bind(c);c.push=e,c=c.slice();for(var d=0;d<c.length;d++)e(c[d]);var u=h;a.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("cd49")},"0ea7":function(t,e,s){},1769:function(t,e,s){},"1ffe":function(t,e,s){},"24d5":function(t,e,s){},"2ada":function(t,e,s){"use strict";s.d(e,"b",(function(){return i})),s.d(e,"c",(function(){return c})),s.d(e,"a",(function(){return o}));s("ddb0"),s("ac1f"),s("1276"),s("466d");class i{constructor(t,e,s){this.cols=t,this.rows=e,this.grid=s||[...Array(e)].map((e,s)=>[...Array(t)].map((e,i)=>s*t+i))}static deserialize(t){return new i(t[0].length,t.length,t)}serialize(){return this.clone().grid}clone(){return new i(this.cols,this.rows,this.grid.map(t=>[...t]))}reset(){for(let t=this.cols*this.rows;t--;)this.grid[Math.floor(t/this.cols)][t%this.cols]=t}move(t){t.axis==o.Row?this.moveRow(t.index,t.n):this.moveColumn(t.index,t.n)}isSolved(){for(let t=this.cols*this.rows;t--;)if(this.grid[Math.floor(t/this.cols)][t%this.cols]!=t)return!1;return!0}pos(t){for(let e=this.rows;e--;)for(let s=this.cols;s--;)if(this.grid[e][s]==t)return{row:e,col:s};throw new Error("Index not found in board")}moveRow(t,e){const s=this.grid[t];this.grid[t]=s.map((t,i)=>s[((i-e)%this.cols+this.cols)%this.cols])}moveColumn(t,e){const s=[...Array(this.rows)].map((e,s)=>this.grid[s][t]);for(let i=0;i<this.rows;i++)this.grid[i][t]=s[((i-e)%this.rows+this.rows)%this.rows]}}var o;s("13d5"),s("2532"),s("25f0");function n(t,e){for(let s=0;s<20;s++){if(null!=e||1==t.cols||1==t.rows)for(let s=0;s<t.cols*t.rows+50;s++){const s=Math.random()>.5?o.Col:o.Row,i=1+Math.floor(Math.random()*(s==o.Col?t.rows-1:t.cols-1));if(null!=e){const{row:n,col:a}=t.pos(e);t.move({axis:s,index:s==o.Col?a:n,n:i})}else t.move({axis:s,index:~~(Math.random()*(s==o.Col?t.cols:t.rows)),n:i})}else a(t);if(!t.isSolved())return}}function a(t){const e=[...Array(t.cols*t.rows)].map((t,e)=>e);l(e),t.cols*t.rows%2&&r(e)%2&&([e[0],e[1]]=[e[1],e[0]]),t.grid=t.grid.map(t=>t.map(t=>e[t]))}function r(t){let e=0;for(let s=0;s<t.length;s++)for(let i=s+1;i<t.length;i++)t[s]>t[i]&&(e+=1);return e}function l(t){for(let e=t.length-1;e>0;e--){const s=Math.floor(Math.random()*(e+1));[t[e],t[s]]=[t[s],t[e]]}return t}class c{constructor(t,e,s){this.canvas=t,this.cols=e,this.rows=s,this.darkText=!1,this.boldText=!1,this.noRegrips=!1,this.activeTile=0,this.blind=!1,this.locked=!1,this.letterSystem="numbers",this.transitionTime=150,this.pointers=new Map,this.transitions=new Map,this.moveAxis=o.Row,this.spaceDown=!1,this.highlightActive=!1,this.repaint=!0,this.frame=()=>{const t=performance.now();0!=this.transitions.size&&(this.repaint=!0);for(const[e,s]of this.transitions.entries())s.time=(t-s.startTime)/s.duration,s.value=s.start-s.start*s.time*(2-s.time),s.time>=1&&this.transitions.delete(e);(this.repaint||this.noRegrips||this.highlightActive)&&(this.render(t),this.repaint=!1),requestAnimationFrame(this.frame)},this.onTouchStart=(t,e,s)=>{if(this.locked)return;const i={x:e,y:s,moveX:0,moveY:0,col:Math.floor(e*devicePixelRatio/this.width*this.cols),row:Math.floor(s*devicePixelRatio/this.height*this.rows)};this.pointers.set(t,i),this.noRegrips&&!this.board.isSolved()||(this.activeTile=this.board.grid[i.row][i.col])},this.onTouchMove=(t,e,s)=>{const i=this.pointers.get(t);if(!i)return;let n=Math.floor(e*devicePixelRatio/this.width*this.cols),a=Math.floor(s*devicePixelRatio/this.height*this.rows);i.moveX+=n-i.col,i.moveY+=a-i.row;const r=(i.row%this.rows+this.rows)%this.rows,l=[...this.pointers.values()].filter(t=>t.row==r),c=Math.trunc(l.reduce((t,e)=>t+e.moveX,0)/l.length);if(c){for(let t=Math.abs(c);t--;)this.animatedMove({axis:o.Row,index:r,n:Math.sign(c)},!0);l.forEach(t=>t.moveX=0)}i.col=n;const h=(i.col%this.cols+this.cols)%this.cols,d=[...this.pointers.values()].filter(t=>t.col==h),u=Math.trunc(d.reduce((t,e)=>t+e.moveY,0)/d.length);if(u){for(let t=Math.abs(u);t--;)this.animatedMove({axis:o.Col,index:h,n:Math.sign(u)},!0);d.forEach(t=>t.moveY=0)}i.row=a,i.x=e,i.y=s,this.highlightActive=!1,this.repaint=!0},this.multiplierString="",this.handleKeyDown=t=>{const e=(e,s)=>{const i=this.board.pos(this.activeTile),n=parseInt(this.multiplierString);this.multiplierString="",n?s*=Math.min(n,e==o.Col?this.rows:this.cols):(t.ctrlKey||t.shiftKey)&&(s*=2),this.spaceDown||this.noRegrips?this.animatedMove({axis:e,index:e==o.Col?i.col:i.row,n:s},!0):e==o.Row?this.activeTile=this.board.grid[i.row][((i.col+s)%this.cols+this.cols)%this.cols]:this.activeTile=this.board.grid[((i.row+s)%this.rows+this.rows)%this.rows][i.col]};switch("1234567890".includes(t.key)&&(clearTimeout(this.multiplierTimeout),this.multiplierTimeout=setTimeout(()=>this.multiplierString="",1e3),this.multiplierString+=t.key),t.key){case" ":this.spaceDown=!0;break;case"ArrowLeft":case"a":case"h":e(o.Row,-1);break;case"ArrowRight":case"d":case"l":e(o.Row,1);break;case"ArrowUp":case"w":case"k":e(o.Col,-1);break;case"ArrowDown":case"s":case"j":e(o.Col,1);break;default:return!0}this.highlightActive=!0,t.preventDefault()},this.handleKeyUp=t=>{" "==t.key&&(this.spaceDown=!1)},this.canvas.tabIndex=0,this.ctx=t.getContext("2d"),this.addEventListeners(),this.setBoardSize(e,s),requestAnimationFrame(this.frame)}setBoardSize(t,e){e||(e=t),this.board=new i(t,e),this.rows=e,this.cols=t,null!=this.width&&this.setWidth(this.width/devicePixelRatio)}setWidth(t){this.width=Math.round(t*devicePixelRatio),this.height=this.width/(this.cols/this.rows),this.updateCanvas()}setHeight(t){this.height=Math.round(t*devicePixelRatio),this.width=this.height*(this.cols/this.rows),this.updateCanvas()}updateCanvas(){this.canvas.width=this.width,this.canvas.height=this.height,this.canvas.style.width=this.width/devicePixelRatio+"px",this.canvas.style.height=this.height/devicePixelRatio+"px",this.tileSize=Math.ceil(this.width/this.cols+.1),this.ctx.textBaseline="middle",this.ctx.textAlign="center",this.repaint=!0}setBlind(t){this.blind=t,this.repaint=!0}setDarkText(t){this.darkText=t,this.repaint=!0}setBoldText(t){this.boldText=t,this.repaint=!0}setLetterSystem(t){this.letterSystem=t,this.repaint=!0}setBoard(t){this.board=t,this.repaint=!0}move(t,e=!1){if(this.noRegrips){const s=this.board.pos(this.activeTile);if(e&&(t.axis==o.Col?s.col:s.row)!=t.index)return!1}return this.board.move(t),this.repaint=!0,this.onMove&&this.onMove(t,e),!0}animatedMove(t,e=!1){this.move(t,e)&&0!=this.transitionTime&&(t.axis!=this.moveAxis&&(this.transitions.clear(),this.moveAxis=t.axis),this.transitions.set(t.index,{start:-t.n,value:-t.n,startTime:performance.now(),time:0,duration:this.transitionTime}))}scramble(){n(this.board,this.noRegrips?this.activeTile:void 0),this.repaint=!0}render(t){const e=this.cols*this.rows,s="letters-xy"==this.letterSystem?2:"letters"==this.letterSystem&&e<=26?1.7:e<=1e3?e<=100?e<=10?1.7:1.9:2.5:4,i=this.tileSize*(.26+.58/s);this.ctx.font=`${this.boldText?500:400} ${i}px Lexend, Roboto, sans-serif`,this.ctx.clearRect(0,0,this.width,this.height);for(let n=0;n<(this.moveAxis==o.Col?this.cols:this.rows);n++){const s=this.transitions.get(n),a=s?s.value:0,r=this.moveAxis==o.Col?this.rows:this.cols;for(let l=Math.floor(-a);l<r-Math.floor(a);l++){let c=n,h=(l%r+r)%r,d=l+a,u=n;if(this.moveAxis==o.Col){const t=c;c=h,h=t;const e=d;d=u,u=e}d=Math.floor(d/this.cols*this.width),u=Math.floor(u/this.rows*this.height);const m=this.board.grid[c][h];if(this.blind){const t=s?s.time**.5:0,e=Math.floor(60*(t<.5?2*t:2-2*t)),i=.03*this.tileSize;this.ctx.fillStyle=`rgb(${100+e},${106+e},${118+e})`,this.ctx.fillRect(d+i,u+i,this.tileSize-2*i,this.tileSize-2*i)}else{const t=(m%this.cols+.1)/(this.cols-.7),s=(Math.floor(m/this.cols)+.2)/(this.rows-.6),o=252*(1-t),n=228*s+t*(1-s)*40,a=220*t;this.ctx.fillStyle=`rgb(${Math.floor(o)},${Math.floor(n)},${Math.floor(a)})`,this.ctx.fillRect(Math.floor(d),Math.floor(u),this.tileSize,this.tileSize),this.ctx.fillStyle=this.darkText?"rgba(0, 0, 0, 0.9)":"#fff";let r="";if("letters"==this.letterSystem&&e<=26)r=String.fromCharCode(m+65);else if("letters-xy"==this.letterSystem){const t=Math.floor(m/this.rows),e=m%this.cols;r=String.fromCharCode(t+(t<26?65:71))+String.fromCharCode(e+(e<26?65:71))}else r=(m+1).toString();this.ctx.fillText(r,d+Math.floor(this.tileSize/2),u+Math.floor(this.tileSize/2+.05*i))}if((this.noRegrips||this.highlightActive)&&m==this.activeTile){const e=this.ctx.lineWidth=.1*this.tileSize|0;this.ctx.strokeStyle=`rgba(255, 255, 255, ${.2*(2+Math.sin(t/100))})`,this.ctx.strokeRect(d+e/2,u+e/2,this.tileSize-e,this.tileSize-e)}}}}addEventListeners(){let t;this.canvas.addEventListener("mousedown",e=>{0==e.button&&(e.preventDefault(),t=this.canvas.getBoundingClientRect(),this.canvas.focus(),this.onTouchStart(-1,e.clientX-t.left,e.clientY-t.top))}),addEventListener("mousemove",e=>{this.pointers.has(-1)&&this.onTouchMove(-1,e.clientX-t.left,e.clientY-t.top)}),addEventListener("mouseup",()=>{this.pointers.delete(-1)}),this.canvas.addEventListener("touchstart",e=>{e.preventDefault(),t=this.canvas.getBoundingClientRect();for(let s of e.changedTouches)this.onTouchStart(s.identifier,s.clientX-t.left,s.clientY-t.top)},{passive:!1}),this.canvas.addEventListener("touchmove",e=>{for(let s of e.changedTouches)this.onTouchMove(s.identifier,s.clientX-t.left,s.clientY-t.top)},{passive:!1}),this.canvas.addEventListener("touchend",t=>{for(let e of t.changedTouches)this.pointers.delete(e.identifier)}),this.canvas.addEventListener("keydown",this.handleKeyDown),this.canvas.addEventListener("keyup",this.handleKeyUp),this.canvas.addEventListener("blur",()=>{this.highlightActive=!1,this.repaint=!0})}}(function(t){t[t["Row"]=0]="Row",t[t["Col"]=1]="Col"})(o||(o={}))},"30f7":function(t,e,s){"use strict";s("1769")},"44c8":function(t,e,s){"use strict";s("db19")},"45d9":function(t,e,s){},"6efe":function(t,e,s){"use strict";s("7d45")},"7d45":function(t,e,s){},"83ca":function(t,e,s){"use strict";s("ad20")},ad20:function(t,e,s){},ad9c:function(t,e,s){"use strict";s("0ea7")},adb1:function(t,e,s){},b064:function(t,e,s){"use strict";s("45d9")},b754:function(t,e,s){"use strict";s("24d5")},bcbc:function(t,e,s){"use strict";s.d(e,"a",(function(){return i})),s.d(e,"b",(function(){return o}));s("4e82"),s("143c"),s("219c"),s("b39a"),s("ddb0");function i(t){t.sort();const e=t.length>3?Math.ceil(t.length/20):0;let s=0;for(let i=e;i<t.length-e;i++){if(-1==t[i])return-1;s+=t[i]}return s/(t.length-2*e)}async function o(t){const e=new Int32Array(t.allSolves.map(t=>t.dnf?-1:t.time)),s=new Int32Array(t.allSolves.map(t=>t.dnf?-1:t.moves.length)),o=new Map;for(const n of[1,3,5,12,50,100]){if(e.length<n)continue;let t=1/0,a=-1,r=1/0,l=-1;for(let o=0;o<e.length-n+1;o++){const c=i(e.slice(o,o+n));c>a&&(a=c),-1!=c&&c<t&&(t=c);const h=i(s.slice(o,o+n));h>l&&(l=h),-1!=h&&h<r&&(r=h)}t==1/0&&(t=-1),r==1/0&&(r=-1),o.set(n,{worstTime:a,bestTime:t,currentTime:i(e.slice(-n)),fewestMoves:r,mostMoves:l,currentMoves:i(s.slice(-n))})}return o}},c1b7:function(t,e,s){"use strict";s.d(e,"d",(function(){return o})),s.d(e,"a",(function(){return a})),s.d(e,"b",(function(){return r})),s.d(e,"c",(function(){return l}));s("ddb0"),s("2b3d"),s("2ca0");var i=s("2b0e");const o=i["a"].observable({user:null}),n=location.origin+"/oauth-callback.html";async function a(){open("https://discordapp.com/api/v6/oauth2/authorize?"+new URLSearchParams({client_id:"670368866085634049",redirect_uri:n,response_type:"code",scope:"identify",state:"discord"}))}async function r(){open("https://accounts.google.com/o/oauth2/v2/auth?"+new URLSearchParams({client_id:"785744823083-iampmadmgr39ilhottfdnlabev4fr2it.apps.googleusercontent.com",redirect_uri:n,response_type:"code",access_type:"offline",prompt:"consent",scope:"profile",state:"google"}))}async function l(){o.user=null}addEventListener("message",t=>{if("string"!=typeof t.data||!t.data.startsWith("?"))return;const e=new URLSearchParams(t.data),s=e.get("error");if(s)return console.error(s);const i=e.get("code"),a=e.get("state");if(!a||!i)return console.error("invalid auth response");fetch(`/api/authenticate/${a}?${new URLSearchParams({code:i,redirect_uri:n})}`,{method:"POST"}).then(async t=>{if(!t.ok)throw new Error(t.statusText);o.user=await t.json()}).catch(console.error)}),new i["a"]({data:o}).$watch(()=>o.user,t=>{localStorage.loopoverUser=JSON.stringify(t)});try{const t=JSON.parse(localStorage.loopoverUser);o.user=t,o.user&&fetch("/api/me",{headers:{Authorization:"Bearer "+o.user.token}}).then(async t=>{if(401==t.status)o.user=null;else if(t.ok){const e=await t.json();Object.assign(o.user,e)}else console.error(t.statusText)})}catch(c){}},c32d:function(t,e){if("undefined"===typeof moment){var s=new Error("Cannot find module 'moment'");throw s.code="MODULE_NOT_FOUND",s}t.exports=moment},caab:function(t,e,s){"use strict";s("adb1")},cce4:function(t,e,s){"use strict";s("1ffe")},cd49:function(t,e,s){"use strict";s.r(e);s("e6cf"),s("cca6"),s("a79d");var i=s("2b0e"),o=s("9483"),n=s("f3ea"),a=(s("f5df1"),s("db43"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("Main"),s("Footer"),t.$state.reloadPage?s("div",{staticClass:"update-notification dark"},[s("span",[t._v("A new version is available. Please reload to update.")]),s("button",{staticClass:"btn secondary",on:{click:t.$state.reloadPage}},[t._v("Reload")]),s("button",{staticClass:"btn",on:{click:function(e){t.$state.reloadPage=null}}},[s("svg",{attrs:{width:"20",viewBox:"0 0 24 24"}},[s("path",{attrs:{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z",fill:"currentColor"}})])])]):t._e()],1)}),r=[],l=s("9ab4"),c=s("1b40"),h=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"app"},[s("div",{staticClass:"main-container"},[s("div",{staticClass:"main-wrapper",class:{desktopMode:t.desktopMode}},[s("h1",[t._v("Loopover")]),s("main",{ref:"main"},[t.desktopMode?t._e():s("div",{staticClass:"top"},[s("Solve",{staticClass:"solve"}),s("button",{staticClass:"btn",on:{click:t.handleMainButtonClick}},[t._v(t._s(t.mainButtonText))]),t.$state.showUndoRedo?[s("div",{staticStyle:{"margin-left":"8px"}}),s("div",{staticClass:"fmc-top",class:{break:t.mainWidth<380}},[s("button",{staticClass:"btn",attrs:{disabled:!t.$state.undoable},on:{click:function(e){return t.$state.undo(!0)}}},[t._v(" Undo "),s("br"),t._v("to start ")]),s("button",{staticClass:"btn",attrs:{disabled:!t.$state.redoable},on:{click:function(e){return t.$state.redo(!0)}}},[t._v(" Redo "),s("br"),t._v("to end ")])]),s("RepeatButton",{staticClass:"btn",attrs:{disabled:!t.$state.undoable},on:{click:function(e){return t.$state.undo()}}},[t._v("Undo")]),s("RepeatButton",{staticClass:"btn",attrs:{disabled:!t.$state.redoable},on:{click:function(e){return t.$state.redo()}}},[t._v("Redo")])]:t._e()],2),s("canvas",{ref:"canvas"}),s("div",{staticClass:"bottom"},[s("button",{staticClass:"btn",on:{click:function(e){t.eventDialog=!0}}},[t._v("Event: "+t._s(t.eventName))]),s("div",{staticStyle:{"flex-grow":"1"}}),s("button",{staticClass:"btn",on:{click:function(e){t.settingsDialog=!0}}},[t._v("Settings")])])]),t.desktopMode?s("aside",{style:{width:t.sidebarWidth+"px"}},[s("button",{staticClass:"btn filled",on:{click:t.handleMainButtonClick}},[t._v(t._s(t.mainButtonText))]),t.$state.showUndoRedo?s("div",{staticClass:"fmc-button-wrapper"},[s("RepeatButton",{staticClass:"btn",attrs:{disabled:!t.$state.undoable},on:{click:function(e){return t.$state.undo()}}},[t._v("Undo")]),s("RepeatButton",{staticClass:"btn",attrs:{disabled:!t.$state.redoable},on:{click:function(e){return t.$state.redo()}}},[t._v("Redo")]),s("button",{staticClass:"btn",attrs:{disabled:!t.$state.undoable},on:{click:function(e){return t.$state.undo(!0)}}},[t._v("Undo to start")]),s("button",{staticClass:"btn",attrs:{disabled:!t.$state.redoable},on:{click:function(e){return t.$state.redo(!0)}}},[t._v("Redo to end")])],1):t._e(),s("transition",{attrs:{name:"record"}},[t.newRecord?s("p",{staticClass:"new-record"},[t._v(t._s(t.newRecord))]):t._e()]),s("Solve",{staticClass:"current-solve"}),s("SolveList",{attrs:{solves:t.$state.solves,limit:t.sidebarLimit,fmc:t.fmc}})],1):t._e()])]),t.$state.inspecting?s("section",{staticClass:"inspect"},[s("time",[t._v(t._s(t.formatDate(t.$state.startTime)))]),s("button",{staticClass:"btn",attrs:{disabled:!t.$state.redoable&&!t.$state.replaying},on:{click:function(e){return t.$state.replay(!t.$state.replaying)}}},[s("svg",{staticStyle:{"margin-right":"8px"},attrs:{height:"24",viewBox:"0 0 24 24",width:"24"}},[t.$state.replaying?s("path",{attrs:{d:"M6 19h4V5H6v14zm8-14v14h4V5h-4z",fill:"currentColor"}}):s("path",{attrs:{d:"M8 5v14l11-7z",fill:"currentColor"}})]),t._v(" "+t._s(t.$state.replaying?"Pause":"Start")+" replay ")])]):t._e(),t.fmc?s("Solutions"):t._e(),t.$state.allSolves.length-t.$state.solves.length>0||t.$state.solves.length>t.sidebarLimit?s("section",[s("transition",{attrs:{name:"record"}},[!t.desktopMode&&t.newRecord?s("p",{staticClass:"new-record"},[t._v(t._s(t.newRecord))]):t._e()]),s("SolveList",{attrs:{solves:t.$state.allSolves,skip:Math.min(t.sidebarLimit,t.$state.solves.length),limit:Math.min(Math.max(t.$state.solves.length-t.sidebarLimit,0),10),fmc:t.fmc,inspectHint:""}})],1):s("section",[t._m(0)]),s("Statistics"),s("Dialog",{attrs:{title:"Confirm scramble",open:t.confirmScrambleDialog},on:{"update:open":function(e){t.confirmScrambleDialog=e},confirm:function(e){return t.$state.scramble()}}},[s("p",{staticStyle:{margin:"0"}},[t._v("Do you want to reset the current solve and generate a new scramble?")])]),s("EventDialog",{attrs:{open:t.eventDialog},on:{"update:open":function(e){t.eventDialog=e}}}),s("SettingsDialog",{attrs:{open:t.settingsDialog},on:{"update:open":function(e){t.settingsDialog=e}}})],1)},d=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",[t._v(" Tap "),s("span",{staticStyle:{"font-size":"14px","font-weight":"600"}},[t._v("SCRAMBLE")]),t._v(" and use your fingers, mouse or arrow keys to move the tiles back to their original place. ")])}],u=(s("ddb0"),s("ac1f"),s("5319"),s("2ada")),m=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("transition",{attrs:{name:"fade"}},[t.open?s("div",{staticClass:"dialog-container",class:{open:t.open},on:{touchstart:function(e){if(e.target!==e.currentTarget)return null;t.clickOutside=!0},mousedown:function(e){t.clickOutside=e.target==t.$el},click:function(e){t.clickOutside&&t.close(e)}}},[s("div",{ref:"dialog",staticClass:"dialog",attrs:{tabindex:"-1"},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.close.apply(null,arguments)}}},[s("h3",{staticClass:"title"},[t._v(t._s(t.title))]),s("div",{staticClass:"content"},[t._t("default")],2),s("div",{staticClass:"actions"},[t.$listeners.confirm?[s("button",{staticClass:"btn",on:{click:t.close}},[t._v("Cancel")]),s("button",{staticClass:"btn",on:{click:function(e){t.$emit("confirm"),t.close()}}},[t._v("Confirm")])]:[s("button",{staticClass:"btn",on:{click:t.close}},[t._v("Close")])]],2)])]):t._e()])},v=[],p=i["a"].extend({props:{open:Boolean,title:String},data(){return{clickOutside:!0}},watch:{open(){this.open&&setTimeout(()=>{this.$refs.dialog.focus()})}},methods:{close(t){t&&t.stopPropagation(),this.$emit("update:open",!1)}}}),f=p,b=(s("30f7"),s("2877")),g=Object(b["a"])(f,m,v,!1,null,"2b44ef10",null),w=g.exports,y=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Dialog",{attrs:{title:"Settings",open:t.open},on:{"update:open":function(e){return t.$emit("update:open",e)}}},[s("label",{staticClass:"checkbox"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.$state.darkMode,expression:"$state.darkMode"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.$state.darkMode)?t._i(t.$state.darkMode,null)>-1:t.$state.darkMode},on:{change:function(e){var s=t.$state.darkMode,i=e.target,o=!!i.checked;if(Array.isArray(s)){var n=null,a=t._i(s,n);i.checked?a<0&&t.$set(t.$state,"darkMode",s.concat([n])):a>-1&&t.$set(t.$state,"darkMode",s.slice(0,a).concat(s.slice(a+1)))}else t.$set(t.$state,"darkMode",o)}}}),s("span",[t._v("Dark mode")])]),s("label",{staticClass:"checkbox"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.$state.forceMobile,expression:"$state.forceMobile"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.$state.forceMobile)?t._i(t.$state.forceMobile,null)>-1:t.$state.forceMobile},on:{change:function(e){var s=t.$state.forceMobile,i=e.target,o=!!i.checked;if(Array.isArray(s)){var n=null,a=t._i(s,n);i.checked?a<0&&t.$set(t.$state,"forceMobile",s.concat([n])):a>-1&&t.$set(t.$state,"forceMobile",s.slice(0,a).concat(s.slice(a+1)))}else t.$set(t.$state,"forceMobile",o)}}}),s("span",[t._v("Force mobile mode")])]),s("label",{staticClass:"checkbox"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.$state.darkText,expression:"$state.darkText"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.$state.darkText)?t._i(t.$state.darkText,null)>-1:t.$state.darkText},on:{change:function(e){var s=t.$state.darkText,i=e.target,o=!!i.checked;if(Array.isArray(s)){var n=null,a=t._i(s,n);i.checked?a<0&&t.$set(t.$state,"darkText",s.concat([n])):a>-1&&t.$set(t.$state,"darkText",s.slice(0,a).concat(s.slice(a+1)))}else t.$set(t.$state,"darkText",o)}}}),s("span",[t._v("Dark text")])]),s("label",{staticClass:"checkbox"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.$state.boldText,expression:"$state.boldText"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.$state.boldText)?t._i(t.$state.boldText,null)>-1:t.$state.boldText},on:{change:function(e){var s=t.$state.boldText,i=e.target,o=!!i.checked;if(Array.isArray(s)){var n=null,a=t._i(s,n);i.checked?a<0&&t.$set(t.$state,"boldText",s.concat([n])):a>-1&&t.$set(t.$state,"boldText",s.slice(0,a).concat(s.slice(a+1)))}else t.$set(t.$state,"boldText",o)}}}),s("span",[t._v("Use bold font")])]),s("label",{staticClass:"checkbox"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.$state.animations,expression:"$state.animations"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.$state.animations)?t._i(t.$state.animations,null)>-1:t.$state.animations},on:{change:function(e){var s=t.$state.animations,i=e.target,o=!!i.checked;if(Array.isArray(s)){var n=null,a=t._i(s,n);i.checked?a<0&&t.$set(t.$state,"animations",s.concat([n])):a>-1&&t.$set(t.$state,"animations",s.slice(0,a).concat(s.slice(a+1)))}else t.$set(t.$state,"animations",o)}}}),s("span",[t._v("Enable animations")])]),t.$state.animations?s("label",{staticClass:"label"},[t._v("Transition speed")]):t._e(),s("div",{directives:[{name:"show",rawName:"v-show",value:t.$state.animations,expression:"$state.animations"}],staticClass:"slider-container"},[s("Slider",{staticClass:"slider",attrs:{min:100,max:200,step:10},model:{value:t.$state.transitionTime,callback:function(e){t.$set(t.$state,"transitionTime",e)},expression:"$state.transitionTime"}}),s("span",[t._v(t._s(t.$state.transitionTime)+" ms")])],1),s("label",{staticClass:"label"},[t._v("Letter System")]),s("select",{directives:[{name:"model",rawName:"v-model",value:t.$state.letterSystem,expression:"$state.letterSystem"}],staticClass:"input",staticStyle:{"margin-bottom":"16px"},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.$state,"letterSystem",e.target.multiple?s:s[0])}}},[s("option",{attrs:{value:"numbers"}},[t._v("Numbers")]),s("option",{attrs:{value:"letters"}},[t._v("Letters")]),s("option",{attrs:{value:"letters-xy"}},[t._v("XY Letters")])]),s("div",{staticClass:"spacer"}),s("a",{on:{click:function(e){return t.clearData("event")}}},[t._v("Delete solves for current event")]),s("a",{on:{click:function(e){return t.clearData("all")}}},[t._v("Clear all data")]),s("a",{on:{click:function(e){return t.exportSolves("csv")}}},[t._v("Export solves as CSV")]),s("a",{on:{click:function(e){return t.exportSolves("json")}}},[t._v("Export solves as JSON")]),s("Dialog",{attrs:{title:"all"==t.clearType?"Clear all data":"Delete all data for the current event",open:t.clearDialog},on:{"update:open":function(e){t.clearDialog=e},confirm:function(e){return t.clearData(t.clearType,!0)}}},["event"==t.clearType?s("p",[t._v("All solves from the current event will be gone.")]):s("p",[t._v("This will delete all data including solves and modifications to the settings.")])])],1)},$=[],_=s("5530"),k=(s("0481"),s("2b3d"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"slider",attrs:{tabindex:"0"},on:{mousedown:t.handleTouchStart,touchstart:t.handleTouchStart,keydown:t.handleKeyDown}},[s("div",{staticClass:"track",style:{width:(t.value_-t.min)/(t.max-t.min)*100+"%"}}),s("div",{staticClass:"thumb",style:{left:(t.value_-t.min)/(t.max-t.min)*100+"%"}})])}),x=[];let S=class extends c["c"]{constructor(){super(...arguments),this.active=!1,this.value_=this.value}setValue(t){this.value_=t,this.step>0&&(this.value_=Math.round((this.value_-this.min)/this.step)*this.step+this.min),this.value_=Math.min(Math.max(this.value_,this.min),this.max)}handleKeyDown(t){switch(t.key){case"ArrowUp":this.setValue(this.max);break;case"ArrowDown":this.setValue(this.min);break;case"ArrowLeft":this.setValue(this.value_-this.step);break;case"ArrowRight":this.setValue(this.value_+this.step);break;default:return}t.preventDefault()}handleTouchStart(t){t.cancelable&&t.preventDefault(),this.active=!0,this.$el.focus();const e="touchstart"==t.type?t.touches[0].clientX:t.clientX;this.setValue((e-this.$el.offsetLeft)/this.$el.offsetWidth*(this.max-this.min)+this.min),addEventListener("mousemove",this.handleTouchMove),addEventListener("mouseup",this.handleTouchEnd),addEventListener("touchmove",this.handleTouchMove),addEventListener("touchend",this.handleTouchEnd)}handleTouchMove(t){const e="touchmove"==t.type?t.touches[0].clientX:t.clientX;this.setValue((e-this.$el.offsetLeft)/this.$el.offsetWidth*(this.max-this.min)+this.min)}handleTouchEnd(){this.active=!1,removeEventListener("mousemove",this.handleTouchMove),removeEventListener("mouseup",this.handleTouchEnd),removeEventListener("touchmove",this.handleTouchMove),removeEventListener("touchend",this.handleTouchEnd)}};Object(l["a"])([Object(c["b"])({type:Number,default:0})],S.prototype,"value",void 0),Object(l["a"])([Object(c["b"])({type:Number,default:0})],S.prototype,"min",void 0),Object(l["a"])([Object(c["b"])({type:Number,default:1})],S.prototype,"max",void 0),Object(l["a"])([Object(c["b"])({type:Number,default:.1})],S.prototype,"step",void 0),S=Object(l["a"])([Object(c["a"])({watch:{value_(){this.$emit("input",this.value_)},value(){this.setValue(this.value)}}})],S);var T=S,M=T,C=(s("6efe"),Object(b["a"])(M,k,x,!1,null,"0567fba4",null)),O=C.exports;let j=class extends c["c"]{constructor(){super(...arguments),this.clearDialog=!1,this.clearType=null}async clearData(t,e=!1){if(e)if(this.clearDialog=!1,"event"==t){var s;const t=null===(s=this.$state.db)||void 0===s?void 0:s.transaction("solves","readwrite").objectStore("solves");if(t){let e=await t.index("event").openKeyCursor(this.$state.eventName);if(!e)return;do{t.delete(e.primaryKey)}while(e=await e.continue())}this.$state.user&&await fetch("/api/sync",{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.$state.user.token},body:JSON.stringify(this.$state.allSolves.map(t=>t.startTime))}),this.$state.reset(),this.$emit("update:open",!1)}else indexedDB.deleteDatabase("loopover"),localStorage.removeItem("loopover"),localStorage.removeItem("loopoverUser"),location.reload();else this.clearDialog=!0,this.clearType=t}async exportSolves(t){if(!this.$state.db)return;let e;if("csv"==t)e="event,date,time,moves,memo_time,dnf\n",e+=Object.entries(await this.$state.getSolvesByEvent()).map(([t,e])=>e.map(e=>[t,new Date(e.startTime).toISOString(),e.time,e.moves.length,e.memoTime||0,!!e.dnf]).join("\n")).flat().join("\n");else{const t=await this.$state.db.getAll("solves");e="[\n"+t.map(t=>"  "+JSON.stringify(Object(_["a"])(Object(_["a"])({},t),{},{session:void 0}))).join(",\n")+"\n]"}track("event","settings","export",t);const s=URL.createObjectURL(new Blob([e],{type:"csv"==t?"text/csv":"application/json"})),i=document.createElement("a");i.href=s,i.download="solves."+t,document.body.append(i),i.click(),i.remove(),URL.revokeObjectURL(s)}};Object(l["a"])([Object(c["b"])(Boolean)],j.prototype,"open",void 0),j=Object(l["a"])([Object(c["a"])({components:{Slider:O,Dialog:w}})],j);var R=j,D=R,A=(s("b754"),Object(b["a"])(D,y,$,!1,null,"ac83fa7a",null)),E=A.exports,L=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Dialog",{attrs:{title:"Event",open:t.open},on:{"update:open":function(e){return t.$emit("update:open",e)}}},[t._l([3,4,5,6,7,8,9,10,-1],(function(e){return s("button",{key:e,staticClass:"btn filled",class:{active:t.$state.rows==e&&t.$state.cols==e||t.$state.custom&&-1==e},staticStyle:{margin:"0 8px 8px 0"},on:{click:function(s){e>0?t.$state.changeSize(e):t.$state.custom=!0}}},[t._v(t._s(e>0?e+"×"+e:"Custom"))])})),t.$state.custom?s("div",{staticStyle:{display:"flex","margin-bottom":"16px"}},[s("div",{staticStyle:{width:"50%","padding-right":"8px"}},[s("label",{staticClass:"label"},[t._v("Columns")]),s("input",{directives:[{name:"model",rawName:"v-model.number.lazy",value:t.$state.cols,expression:"$state.cols",modifiers:{number:!0,lazy:!0}}],staticClass:"input",attrs:{type:"number",min:"1",max:"50"},domProps:{value:t.$state.cols},on:{change:function(e){t.$set(t.$state,"cols",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})]),s("div",{staticStyle:{"flex-grow":"1","padding-left":"8px"}},[s("label",{staticClass:"label"},[t._v("Rows")]),s("input",{directives:[{name:"model",rawName:"v-model.number.lazy",value:t.$state.rows,expression:"$state.rows",modifiers:{number:!0,lazy:!0}}],staticClass:"input",attrs:{type:"number",min:"1",max:"50"},domProps:{value:t.$state.rows},on:{change:function(e){t.$set(t.$state,"rows",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})])]):t._e(),s("label",{staticClass:"label"},[t._v("Event type")]),s("select",{directives:[{name:"model",rawName:"v-model",value:t.$state.event,expression:"$state.event"}],staticClass:"input",staticStyle:{"margin-bottom":"16px"},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.$state,"event",e.target.multiple?s:s[0])}}},[s("option",{domProps:{value:0}},[t._v("Normal")]),s("option",{domProps:{value:1}},[t._v("Fewest moves challenge")]),s("option",{domProps:{value:2}},[t._v("Blind")])]),s("label",{staticClass:"checkbox",staticStyle:{"margin-bottom":"12px"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.$state.noRegrips,expression:"$state.noRegrips"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.$state.noRegrips)?t._i(t.$state.noRegrips,null)>-1:t.$state.noRegrips},on:{change:function(e){var s=t.$state.noRegrips,i=e.target,o=!!i.checked;if(Array.isArray(s)){var n=null,a=t._i(s,n);i.checked?a<0&&t.$set(t.$state,"noRegrips",s.concat([n])):a>-1&&t.$set(t.$state,"noRegrips",s.slice(0,a).concat(s.slice(a+1)))}else t.$set(t.$state,"noRegrips",o)}}}),s("span",[t._v("No regrips")])])],2)},B=[],P=i["a"].extend({components:{Dialog:w},props:{open:Boolean}}),N=P,z=Object(b["a"])(N,L,B,!1,null,null,null),H=z.exports,U=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("button",{on:{click:function(e){return t.$emit("click",e)},mousedown:t.start,touchstart:t.start,touchend:t.stop,mouseup:t.stop,blur:t.stop}},[t._t("default")],2)},I=[];let F=class extends c["c"]{constructor(){super(...arguments),this.timeout=0,this.interval=0}start(t){this.stop(),this.timeout=setTimeout(()=>{this.interval=setInterval(()=>{this.$emit("click",new Event("click"))},100)},500)}stop(){clearTimeout(this.timeout),clearInterval(this.interval)}};F=Object(l["a"])([Object(c["a"])({})],F);var W=F,J=W,X=Object(b["a"])(J,U,I,!1,null,null,null),K=X.exports,V=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"solve",class:{fmc:t.fmc,current:t.current,clickable:t.$listeners.click},on:{click:function(e){return t.$emit("click",e)}}},[s("div",{staticClass:"first"},[t._v(t._s(t.fmc?t.movesStr:t.timeStr)+t._s(t.dnf?" DNF":""))]),s("div",{staticClass:"second"},[t._v(t._s(t.fmc?t.timeStr:t.movesStr)+" / "+t._s(t.mps)+" mps")])])},Y=[],q=i["a"].extend({props:{time:Number,moves:Number,fmc:Boolean,dnf:Boolean,current:Boolean},computed:{mps(){return this.time&&Math.round(Math.max(0,this.moves-1)/this.time*1e5)/100},timeStr(){return this.$state.formatTime(this.time)},movesStr(){return this.moves+" moves"}}}),G=q,Q=(s("ad9c"),Object(b["a"])(G,V,Y,!1,null,"6249e074",null)),Z=Q.exports,tt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t._l(t.items,(function(e,i){return s("Solve",{key:i,attrs:{time:e.time,moves:e.moves.length,fmc:t.fmc,dnf:e.dnf},on:{click:function(s){!t.$state.started&&t.$state.inspect(e)}}})})),0==t.solves.length?s("p",{staticStyle:{opacity:"0.8"}},[t._v("No solves yet")]):t._e(),t.showHint?s("p",{staticClass:"hint"},[t._v("You can tap on a solve to inspect it")]):t._e(),null!=t.skip&&t.solves.length-t.skip>t.currentLimit?s("button",{staticClass:"btn",on:{click:function(e){t.currentLimit+=10}}},[t._v("Show older solves")]):t._e()],2)},et=[],st=i["a"].extend({components:{Solve:Z},props:{solves:{type:Array,required:!0},limit:{type:Number,default:0},skip:Number,fmc:Boolean,inspectHint:Boolean},data(){return{currentLimit:this.limit}},watch:{limit(){this.currentLimit=this.limit}},computed:{items(){if(0==this.currentLimit)return[];const t=this.skip||0;return this.solves.slice(Math.max(0,this.solves.length-this.currentLimit-t),this.solves.length-t).reverse()},showHint(){return this.inspectHint&&!this.$state.hideInspectHint&&this.solves.length>=12&&this.items.length>0}}}),it=st,ot=(s("44c8"),Object(b["a"])(it,tt,et,!1,null,"49275337",null)),nt=ot.exports,at=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",[s("div",{staticClass:"btn-container"},[s("button",{staticClass:"btn",attrs:{disabled:!t.$state.started||0==t.$state.moves.length},on:{click:t.saveSolution}},[t._v("Save solution")])]),t._l(t.list,(function(e){var i=e[0],o=e[1];return s("div",{key:o,staticClass:"solution",on:{click:function(e){return t.loadSolution(i)}}},[s("span",{staticClass:"number"},[t._v("Solution "+t._s(o+1))]),s("span",{staticClass:"info"},[t._v(t._s(i.moves.length-i.undos)+" moves")]),t.$state.started?s("button",{staticClass:"btn",on:{click:function(e){e.stopPropagation(),t.deleteSolution(o)}}},[t._v("âœ•")]):t._e()])})),0==t.solutions.length?s("p",{staticClass:"hint"},[t._v("You can save different solutions here during the solve.")]):t._e()],2)},rt=[];let lt=class extends c["c"]{constructor(){super(...arguments),this.solutions=[]}get list(){return this.solutions.map((t,e)=>[t,e]).reverse()}reset(){this.solutions=[]}mounted(){n["c"].$on("reset",this.reset)}beforeDestroy(){n["c"].$off("reset",this.reset)}saveSolution(){this.solutions.push({moves:[...this.$state.moveHistory],undos:this.$state.undos})}loadSolution(t){if(this.$state.scrambledBoard){this.$state.undos=t.undos,this.$state.moveHistory=[...t.moves],this.$state.game.setBoard(this.$state.scrambledBoard.clone());for(const e of t.moves.slice(0,-t.undos||void 0))this.$state.game.move(e)}}deleteSolution(t){this.solutions.splice(t,1)}};lt=Object(l["a"])([Object(c["a"])({})],lt);var ct=lt,ht=ct,dt=(s("83ca"),Object(b["a"])(ht,at,rt,!1,null,"1567851c",null)),ut=dt.exports;let mt=class extends c["c"]{constructor(){super(...arguments),this.refresh=null,this.confirmScrambleDialog=!1,this.eventDialog=!1,this.settingsDialog=!1,this.desktopMode=!1,this.sidebarWidth=240,this.sidebarLimit=12,this.mainWidth=0}get fmc(){return n["b"].event==n["a"].Fmc}get eventName(){return`${n["b"].cols}×${n["b"].rows}`+[""," FMC"," BLD"][n["b"].event]+(n["b"].noRegrips?" NRG":"")}get newRecord(){const t=n["b"].newRecord;if(t)return 1==t.averageOf?`New personal best (-${t.fmc?t.difference+"Â moves":t.difference/1e3+"s"})`:`New best average of ${t.averageOf} (-${t.fmc?Math.round(10*t.difference)/10+"Â moves":Math.round(t.difference)/1e3+"s"})`}get mainButtonText(){return n["b"].inSolvingPhase||n["b"].started&&!n["b"].scrambled?"Done":"Scramble"}formatDate(t){return new Date(t-6e4*(new Date).getTimezoneOffset()).toISOString().slice(0,-5).replace("T"," ")}handleMainButtonClick(){n["b"].inSolvingPhase||n["b"].started&&!n["b"].scrambled?n["b"].done():n["b"].started&&this.fmc?this.confirmScrambleDialog=!0:n["b"].scramble()}updateSize(){const{cols:t,rows:e}=this.game,s=t/e,i=this.$el.clientWidth-32,o=Math.max(150+150/s,innerHeight-96-96),a=this.$el.clientWidth-this.sidebarWidth-32,r=innerHeight-96-48;this.desktopMode=!n["b"].forceMobile&&Math.min(i/s,o)<Math.min(a/s,r)&&e>1&&r>320;const l=this.desktopMode?a:i,c=this.desktopMode?r:o;l/s<c?this.game.setWidth(Math.min(l,50*t+250*Math.max(s,1))):this.game.setHeight(Math.min(c,50*e+250/Math.min(s,1))),this.mainWidth=Math.max(Math.min(i,320),this.game.width/devicePixelRatio),this.$refs.main&&(this.$refs.main.style.width=this.mainWidth+"px"),this.sidebarLimit=this.desktopMode?~~((this.game.height/devicePixelRatio-(n["b"].showUndoRedo?200:150))/36):0}mounted(){const t=new u["c"](this.$refs.canvas,n["b"].cols,n["b"].rows);n["b"].game=this.game=t,this.game.onMove=n["b"].handleMove.bind(this.$state),this.$watch(()=>[n["b"].cols,n["b"].rows,n["b"].event,n["b"].noRegrips],()=>{n["b"].game.setBoardSize(n["b"].cols,n["b"].rows),n["b"].reset()},{immediate:!0}),this.$watch(()=>[n["b"].darkText,n["b"].boldText,n["b"].letterSystem,n["b"].transitionTime,n["b"].animations],()=>{n["b"].game.setDarkText(n["b"].darkText),n["b"].game.setBoldText(n["b"].boldText),n["b"].game.setLetterSystem(n["b"].letterSystem),n["b"].game.transitionTime=n["b"].animations?n["b"].transitionTime:0},{immediate:!0}),this.$refs.canvas.addEventListener("keydown",t=>{switch(t.key){case"u":n["b"].showUndoRedo&&n["b"].undo();break;case"r":n["b"].showUndoRedo&&n["b"].redo();break;case"Enter":this.handleMainButtonClick();break;default:return}}),this.$refs.canvas.style.transition="null",this.$watch(()=>[n["b"].cols,n["b"].rows,n["b"].showUndoRedo,n["b"].forceMobile],this.updateSize,{immediate:!0}),document.body.clientWidth,this.$refs.canvas.style.transition="",window.addEventListener("resize",this.updateSize)}destroyed(){n["b"].reset(),window.removeEventListener("resize",this.updateSize)}};mt=Object(l["a"])([Object(c["a"])({components:{SolveList:nt,RepeatButton:K,Statistics:async()=>(await s.e("chunk-56a3ad15").then(s.bind(null,"069e"))).default,Solutions:ut,Dialog:w,EventDialog:H,SettingsDialog:E,Solve:c["c"].extend({render:t=>t(Z,{props:{current:!0,time:n["b"].displayTime,moves:n["b"].moves,fmc:n["b"].event==n["a"].Fmc,dnf:n["b"].dnf}})})}})],mt);var vt=mt,pt=vt,ft=(s("cce4"),Object(b["a"])(pt,h,d,!1,null,"293322ed",null)),bt=ft.exports,gt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("footer",[t.showShortcuts?s("p",{staticClass:"shortcuts-link"},[s("a",{on:{click:function(e){t.shortcutsDialog=!0}}},[t._v("Show keyboard shortcuts")])]):t._e(),t._m(0),t._m(1),t._m(2),s("div",{staticClass:"auth"},[t.$state.user?s("p",[t.$state.user.avatarUrl?s("img",{attrs:{src:t.$state.user.avatarUrl}}):t._e(),t._v(" Signed in as "+t._s(t.$state.user.name)+" ")]):t._e(),t.$state.user?[s("a",{on:{click:t.signOut}},[t._v("Sign out")])]:[s("p",[t._v("Log in to synchronize your solves.")]),s("a",{on:{click:function(e){return t.signIn("google")}}},[t._v("Sign in with Google")]),s("a",{on:{click:function(e){return t.signIn("discord")}}},[t._v("Sign in with Discord")])]],2),s("ShortcutsDialog",{attrs:{open:t.shortcutsDialog},on:{"update:open":function(e){t.shortcutsDialog=e}}})],1)},wt=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",[t._v(" Created by "),s("a",{attrs:{target:"_blank",rel:"noopener",href:"https://github.com/janispritzkau"}},[t._v("Janis Pritzkau")]),t._v(". ")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",[t._v(" Remake of carykh's "),s("a",{attrs:{target:"_blank",rel:"noopener",href:"https://openprocessing.org/sketch/580366"}},[t._v("Loopover")]),t._v(". ")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",[s("a",{attrs:{target:"_blank",rel:"noopener",href:"https://discord.gg/DXASrTp"}},[t._v("Discord")]),t._v(" | "),s("a",{attrs:{target:"_blank",rel:"noopener",href:"https://github.com/janispritzkau/loopover"}},[t._v("GitHub")])])}],yt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Dialog",{attrs:{title:"Shortcuts",open:t.open},on:{"update:open":function(e){return t.$emit("update:open",e)}}},[s("ul",[s("li",[s("code",[t._v("Space")]),t._v(" move tile when pressing arrow key ")]),s("li",[s("code",[t._v("Ctrl or"),s("br"),t._v("Shift")]),t._v(" move twice when pressing arrow key ")]),s("li",[s("code",[t._v("â†‘, w, k")]),t._v(" move up ")]),s("li",[s("code",[t._v("â†, a, h")]),t._v(" move left ")]),s("li",[s("code",[t._v("â†“, s, j")]),t._v(" move down ")]),s("li",[s("code",[t._v("â†’, d, l")]),t._v(" move right ")]),s("li",[s("code",[t._v("u")]),t._v(" undo ")]),s("li",[s("code",[t._v("r")]),t._v(" redo ")]),s("li",[s("code",[t._v("Enter")]),t._v(" scramble / done in blind mode ")])]),s("p",[t._v("You can type a number before the arrow key to specify how much to move in a direction.")])])},$t=[],_t=i["a"].extend({components:{Dialog:w},props:{open:Boolean}}),kt=_t,xt=(s("b064"),Object(b["a"])(kt,yt,$t,!1,null,"057d1b30",null)),St=xt.exports,Tt=s("c1b7");let Mt=class extends c["c"]{constructor(){super(...arguments),this.shortcutsDialog=!1}get showShortcuts(){return!("ontouchstart"in window)}async signIn(t){switch(t){case"google":Tt["b"]();break;case"discord":Tt["a"]();break}}async signOut(){Tt["c"]()}};Mt=Object(l["a"])([Object(c["a"])({components:{ShortcutsDialog:St}})],Mt);var Ct=Mt,Ot=Ct,jt=(s("caab"),Object(b["a"])(Ot,gt,wt,!1,null,"c7fb54d4",null)),Rt=jt.exports;let Dt=class extends c["c"]{reload(){location.reload()}};Dt=Object(l["a"])([Object(c["a"])({components:{Main:bt,Footer:Rt}})],Dt);var At=Dt,Et=At,Lt=Object(b["a"])(Et,a,r,!1,null,null,null),Bt=Lt.exports;i["a"].config.productionTip=!1,i["a"].prototype.$state=n["b"],window.state=n["b"],new i["a"]({render:t=>t(Bt)}).$mount("#app");{let t=!1;addEventListener("click",()=>{t=!0}),addEventListener("touchstart",e=>{e.target==n["b"].game.canvas&&(t=!0)},{passive:!0}),Object(o["a"])("service-worker.js",{registered(t){t.update()},updated(e){e.waiting.postMessage({type:"SKIP_WAITING"}),t?n["b"].reloadPage=()=>location.reload():location.reload()}})}},db19:function(t,e,s){},db43:function(t,e,s){},f3ea:function(t,e,s){"use strict";s.d(e,"a",(function(){return w})),s.d(e,"b",(function(){return k})),s.d(e,"c",(function(){return x}));var i=s("2b0e"),o=s("5530"),n=(s("ddb0"),s("25f0"),s("13d5"),s("15fd")),a=s("3f4f"),r=s("2ada");const l=["cols","rows","event"],c=["event","session"];function h(t,e){if(0!=e.version)return;const{cols:s,rows:i,event:o}=e,a=Object(n["a"])(e,l);t.cols=s,t.rows=i,t.custom=t.cols!=t.rows||t.cols>10&&20!=t.cols,t.event=o;for(let[n,r]of Object.entries(a))t[n]=r}function d(t){const e={version:0,cols:t.cols,rows:t.rows,event:t.event,letterSystem:t.letterSystem,transitionTime:t.transitionTime};return t.noRegrips&&(e.noRegrips=!0),t.darkText&&(e.darkText=!0),t.boldText&&(e.boldText=!0),t.forceMobile&&(e.forceMobile=!0),t.darkMode&&(e.darkMode=!0),t.hideInspectHint&&(e.hideInspectHint=!0),e}function u(t,e,s){return Object(o["a"])(Object(o["a"])({event:e,session:s},t),{},{moves:b(t.moves),scramble:t.scramble.serialize()})}function m(t){const{event:e,session:s}=t,i=Object(n["a"])(t,c);return{event:e,session:s,solve:Object(o["a"])(Object(o["a"])({},i),{},{moves:g(i.moves),scramble:r["b"].deserialize(i.scramble)})}}async function v(t,e){const s=u(e,t.eventName,t.session);t.db&&t.db.put("solves",s),t.user&&fetch("/api/sync",{method:"PUT",headers:{"api-version":"1","Content-Type":"application/json",Authorization:"Bearer "+t.user.token},body:JSON.stringify([s])})}async function p(t){var e;const s=t.db,i=null===(e=t.user)||void 0===e?void 0:e.token;if(!s||!i)return;const o=await fetch("/api/sync",{method:"POST",headers:{"api-version":"1","Content-Type":"application/json",Authorization:"Bearer "+i},body:JSON.stringify(await s.getAllKeys("solves"))});if(!o.ok)return;const{solves:n,missing:a}=await o.json(),r=s.transaction("solves","readwrite").objectStore("solves");for(const l of n)r.add(l);if(t.allSolves=(await r.index("event").getAll(t.eventName)).map(t=>Object.freeze(m(t).solve))||[],a.length>0){const t=await Promise.all(a.map(t=>r.get(t)));let e=[[]],s=0;for(const i of t){const t=JSON.stringify(i).length;(s+=t)>131072?(e.push([i]),s=t):e[e.length-1].push(i)}for(const o of e){const t=await fetch("/api/sync",{method:"PUT",headers:{"api-version":"1","Content-Type":"application/json",Authorization:"Bearer "+i},body:JSON.stringify(o)});if(!t.ok)return}}}const f=()=>Object(a["a"])("loopover",4,{async upgrade(t,e,s,i){if(1==e&&(t.deleteObjectStore("sessions"),t.deleteObjectStore("solves")),e<2){const e=t.createObjectStore("solves",{keyPath:"startTime"});e.createIndex("session","session",{unique:!1}),e.createIndex("event","event",{unique:!1})}if(e<4){let t=await i.objectStore("solves").openCursor();while(t)t.update(Object(o["a"])(Object(o["a"])({},t.value),{},{moves:b(t.value.moves)})),t=await t.continue()}}});function b(t){let e=0;return t.map(t=>{const s=t.time-e;return e=t.time,[+(t.axis==r["a"].Col),t.index,t.n,s]})}function g(t){let e=0;return t.map(t=>({axis:t[0]?r["a"].Col:r["a"].Row,index:t[1],n:t[2],time:e+=t[3]}))}var w,y=s("bcbc"),$=s("c1b7");class _{constructor(){this.cols=5,this.rows=5,this.custom=!1,this.event=w.Normal,this.noRegrips=!1,this.darkMode=!1,this.forceMobile=!1,this.letterSystem="letters",this.darkText=!1,this.boldText=!1,this.animations=!0,this.transitionTime=150,this.hideInspectHint=!1,this.started=!1,this.scrambled=!1,this.inSolvingPhase=!1,this.dnf=!1,this.time=0,this.startTime=0,this.memoTime=0,this.moveHistory=[],this.undos=0,this.inspecting=!1,this.replaying=!1,this.replaySpeed=1,this.solves=[],this.allSolves=[],this.sessionSolves={},this.newRecord=null,this.averages=new Map,this.session=Date.now(),this.auth=$["d"],this.reloadPage=null}get user(){return $["d"].user}get eventName(){return`${this.cols}x${this.rows}`+["","-fmc","-bld"][this.event]+(this.noRegrips?"-nrg":"")}get displayTime(){return this.inspecting&&!this.replaying?this.undoable?this.moveHistory[this.moveHistory.length-this.undos-1].time:0:this.time}get moves(){return this.moveHistory.length-this.undos}get showUndoRedo(){return this.event==w.Fmc||this.inspecting}get undoable(){return this.undos!=this.moveHistory.length&&!this.replaying}get redoable(){return 0!=this.undos&&!this.replaying}formatTime(t){if(null==t)return"―";t=Math.round(t);const e=t/1e3,s=e/60|0,i=e%60|0,o=Math.round(t%1e3);return`${s}:${i.toString().padStart(2,"0")}.${o.toString().padStart(3,"0")}`}async getSolvesByEvent(){if(!this.db)return{};const t=await this.db.getAll("solves");return t.reduce((t,e)=>{var s;const{event:i,solve:o}=m(e);return(t[i]=null!==(s=t[i])&&void 0!==s?s:[]).push(o),t},{})}start(t=performance.now()){this.started=!0,this.time=0,this.memoTime=0,this.startTime=t,clearInterval(this.interval),this.interval=setInterval(()=>this.time=performance.now()-this.startTime,67),track("event","game","start",this.eventName)}scramble(){this.reset(!0),this.game.scramble(),this.game.canvas.focus(),this.scrambled=!0,this.scrambledBoard=this.game.board.clone(),this.event==w.Blind&&this.start(),track("event","game","scramble",this.eventName)}async reset(t=!1){clearInterval(this.interval),this.started=!1,this.scrambled=!1,this.inSolvingPhase=!1,this.dnf=!1,this.moveHistory=[],this.undos=0,this.time=0,this.memoTime=0,this.inspecting=!1,this.newRecord=null,null==this.sessionSolves[this.eventName]&&(this.sessionSolves[this.eventName]=[]),this.solves=this.sessionSolves[this.eventName]||[],x.$emit("reset"),t||(this.game.setBoardSize(this.cols,this.rows),this.game.setBlind(!1),(this.game.noRegrips=this.noRegrips)&&(this.game.activeTile=this.game.board.grid[Math.floor((this.rows-1)/2)][Math.floor((this.cols-1)/2)]),this.db&&(this.allSolves=(await this.db.getAllFromIndex("solves","event",this.eventName)).map(t=>Object.freeze(m(t).solve))||[],this.updateAverages()))}done(){this.game.setBlind(!1),this.dnf=!this.game.board.isSolved(),this.handleSolved()}undo(t=!1){if(this.undos==this.moveHistory.length)return;const e=this.moveHistory[this.moveHistory.length-this.undos-1];this.game.animatedMove(Object(o["a"])(Object(o["a"])({},e),{},{n:-e.n})),this.undos+=1,t&&this.undoable&&this.undo(!0)}redo(t=!1){if(0==this.undos)return;const e=this.moveHistory[this.moveHistory.length-this.undos];this.game.animatedMove(e),this.undos-=1,t&&this.redoable&&this.redo(!0)}inspect(t){this.reset(!0),this.inspecting=!0,this.replaying=!1,this.startTime=t.startTime,this.time=t.time,this.dnf=!!t.dnf,this.game.setBoard(t.scramble.clone()),this.moveHistory=t.moves,this.undos=t.moves.length,this.hideInspectHint=!0,track("event","game","inspect")}async replay(t=!0){if(track("event","game","replay",t?"start":"pause"),t||(this.replaying=!1),!this.redoable||this.replaying||!t)return;const e=this.replaySpeed,s=performance.now()-this.moveHistory[this.moveHistory.length-this.undos].time/e;this.replaying=!0,clearInterval(this.interval),this.interval=setInterval(()=>this.time=(performance.now()-s)*e,87),this.time=(performance.now()-s)*e;while(0!=this.undos){const t=this.moveHistory[this.moveHistory.length-this.undos],i=t.time/e-performance.now()+s;if(i>0&&await new Promise(t=>setTimeout(t,i)),!this.replaying)break;this.animations&&(this.game.transitionTime=this.transitionTime/e),this.redo()}this.animations&&(this.game.transitionTime=this.transitionTime),clearInterval(this.interval),this.replaying=!1}changeSize(t){this.custom=!1,this.rows=t,this.cols=t}handleMove(t,e){const s=performance.now();if(!this.started&&this.scrambled&&e&&this.start(s),this.started&&(this.scrambled=!this.game.board.isSolved(),e)){this.undos>0&&(this.moveHistory.splice(this.moveHistory.length-this.undos,this.undos),this.undos=0);for(let e=Math.abs(t.n);e--;)this.moveHistory.push(Object.freeze(Object(o["a"])(Object(o["a"])({},t),{},{n:Math.sign(t.n),time:Math.floor(s-this.startTime)})));this.event==w.Blind?this.inSolvingPhase||(this.inSolvingPhase=!0,this.game.setBlind(!0),this.memoTime=performance.now()-this.startTime):this.event==w.Fmc||this.scrambled||this.handleSolved(!0)}}handleSolved(t=!1){clearInterval(this.interval),this.time=t?this.moveHistory[this.moveHistory.length-1].time:performance.now()-this.startTime,this.started=!1,this.scrambled=!1,this.inSolvingPhase=!1;const e={startTime:Math.floor(Date.now()-this.time),time:Math.floor(this.time),moves:[...this.moveHistory],scramble:this.scrambledBoard};this.memoTime>0&&(e.memoTime=Math.floor(this.memoTime)),this.dnf&&(e.dnf=!0),this.solves.push(Object.freeze(e)),this.allSolves.push(e);const s=[1,3,5],i=s.map(t=>this.averages.get(t));this.newRecord=null,setTimeout(()=>this.updateAverages().then(()=>{for(const[t,e]of s.entries()){const s=this.averages.get(e),o=i[t];if(!s||!o)break;if(this.event==w.Fmc&&s.fewestMoves>-1&&s.fewestMoves<o.fewestMoves){this.newRecord={averageOf:e,difference:o.fewestMoves-s.fewestMoves,fmc:!0};break}if(this.event!=w.Fmc&&s.bestTime>-1&&s.bestTime<o.bestTime){this.newRecord={averageOf:e,difference:o.bestTime-s.bestTime,fmc:!1};break}}}),50),track("event","game","solved",this.eventName),v(this,e)}async updateAverages(){await new Promise(t=>setTimeout(t,50)),this.averages=await Object(y["b"])(this)}syncSolves(){return p(this)}}(function(t){t[t["Normal"]=0]="Normal",t[t["Fmc"]=1]="Fmc",t[t["Blind"]=2]="Blind"})(w||(w={}));const k=new _,x=new i["a"]({data:k});f().then(async t=>{IDBObjectStore.prototype.getAll&&(k.db=t,k.reset().then(()=>k.syncSolves()))}),x.$watch(()=>k.auth.user,()=>k.syncSolves()),localStorage.loopover&&h(k,JSON.parse(localStorage.loopover)),x.$watch(()=>d(k),t=>{localStorage.loopover=JSON.stringify(t)},{deep:!0}),x.$watch(()=>[k.cols,k.rows,k.event,k.noRegrips],()=>{k.cols=Math.floor(Math.min(Math.max(k.cols,1),50)),k.rows=Math.floor(Math.min(Math.max(k.rows,1),50))}),i["a"].nextTick(()=>{x.$watch(()=>k.darkMode,t=>{document.body.classList.toggle("dark",t);const e=document.head.querySelector("meta[name=theme-color]");e.content=getComputedStyle(document.body).getPropertyValue("--background"+(t?"-darker":""))},{immediate:!0})})}});
