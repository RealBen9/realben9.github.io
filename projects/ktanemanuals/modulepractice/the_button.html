<title>KTaNE Module Practice - The Button</title>
<head><link rel="icon" type="image/x-icon" href="../../../img/favicon.ico"><link rel="stylesheet" type="text/css" href="../../../style.css"><link rel="stylesheet" type="text/css" href="edgework.css"></head>
<script src="../../../index.js"></script><script src="edgework.js"></script>
<div id="snow">
<p id="strikes" style="color:#f00;font-size:32px;font-family:'Seven_Segment'">__</p>
<p id="clock" onload="currentTime()" style="color:#0ff;font-size:32px;font-family:'Seven_Segment'"></p>
<h1>The Button</h1>
<h2>Edgework</h2>
<div class="edgework" id="info0"></div>
<div id="thebutton" style="width:96px;height:96px;-webkit-border-radius:48px;-moz-border-radius:48px;border-radius:48px;text-align:center"><p id="buttontext" style="position:relative;top:.9em;font-size:32px;font-family:'Ostrich'"></p></div>
<p id="btngrid"><button onclick="buttonpress()">Press</button><button onclick="buttonhold()">Hold</button><div id="light" style="width:128px;height:16px"></div></p>
</div>
<script>
setTimeout(function(){
    thebutton = document.getElementById("thebutton")
    buttontextdisp = document.getElementById("buttontext")
    buttongrid = document.getElementById("btngrid")
    buttoncolour = Math.floor(Math.random() * 4)
    if (buttoncolour == 0) {thebutton.style.backgroundColor = "white"}
    else if (buttoncolour == 1) {thebutton.style.backgroundColor = "red"}
    else if (buttoncolour == 2) {
        thebutton.style.backgroundColor = "blue"
        buttontextdisp.style.color = "white"
    }
    else {thebutton.style.backgroundColor = "yellow"}
    buttontext = Math.floor(Math.random() * 4)
    if (buttontext == 0) {buttontextdisp.innerHTML = "Detonate"}
    else if (buttontext == 1) {buttontextdisp.innerHTML = "Hold"}
    else if (buttontext == 2) {buttontextdisp.innerHTML = "Abort"}
    else {buttontextdisp.innerHTML = "Press"}
    if (indcount == 0) {
        ind0 = -1
        lit0 = -1
        ind1 = -1
        lit1 = -1
    }
    else if (indcount == 1) {
        ind1 = -1
        lit1 = -1
    }
    if (buttoncolour == 1 && buttontext == 1) {
        console.log("[" + time + "] Rule 1 : Tap")
        tap = true
    }
    else if (batteries >= 2 && buttontext == 0) {
        console.log("[" + time + "] Rule 2 : Tap")
        tap = true
    }
    else if (buttoncolour == 2 && buttontext == 2) {
        console.log("[" + time + "] Rule 3 : Hold")
        tap = false
    }
    else if (((ind0 == "CAR" && lit0 == 1) || (ind1 == "CAR" && lit1 == 1)) && buttoncolour == 0) {
        console.log("[" + time + "] Rule 4 : Hold")
        tap = false
    }
    else if (batteries >= 3 && ((ind0 == "FRK" && lit0 == 1) || (ind1 == "FRK" && lit1 == 1))) {
        console.log("[" + time + "] Rule 5 : Tap")
        tap = true
    }
    else {
        console.log("[" + time + "] Rule 6 : Hold")
        tap = false
    }
},33)
function buttonpress() {
    console.log("[" + time + "] Tapping!")
    if (tap == true) {
        buttongrid.innerHTML = ""
        solve()
    }
    else strike()
}
function buttonhold() {
    console.log("[" + time + "] Holding!")
    lightcolour = Math.floor(Math.random() * 4)
    if (lightcolour == 0) {
        console.log("[" + time + "] Chosen Light Colour : Blue (4)")
        lightdisp = "#00f"
    }
    else if (lightcolour == 1) {
        console.log("[" + time + "] Chosen Light Colour : White (1)")
        lightdisp = "#fff"
    }
    else if (lightcolour == 2) {
        console.log("[" + time + "] Chosen Light Colour : Yellow (5)")
        lightdisp = "#ff0"
    }
    else {
        console.log("[" + time + "] Chosen Light Colour : Red (1)")
        lightdisp = "#f00"
    }
    buttongrid.innerHTML = '<button onclick="buttonrelease()">Release</button><div id="light" style="width:128px;height:16px;background-color:' + lightdisp + '"></div>'
}
/*
The search() method matches a string against a regular expression *
The search() method returns the index (position) of the first match.
The search() method returns -1 if no match is found.
The search() method is case sensitive.
*If the search value is a string, it is converted to a regular expression.
*/
function buttonrelease() {
    console.log("[" + time + "] Releasing!")
    if (tap == false) {
        if (lightcolour == 0 && time.search("4") != -1) {
            buttongrid.innerHTML = ""
            solve()
        }
        else if (lightcolour == 2 && time.search("5") != -1) {
            buttongrid.innerHTML = ""
            solve()
        }
        else if (time.search("1") != -1) {
            buttongrid.innerHTML = ""
            solve()
        }
        else {
        buttongrid.innerHTML = '<button onclick="buttonpress()">Press</button><button onclick="buttonhold()">Hold</button>'
        strike()
        }
    }
    else {
        buttongrid.innerHTML = '<button onclick="buttonpress()">Press</button><button onclick="buttonhold()">Hold</button>'
        strike()
    }
}
</script>
<script>
modulesolved = false
strikes = 0
striketimer = 0
mm = 0
ss = 0
ms = 0
function currentTime() {
    if (modulesolved == false) {
        ms = ms + (17 * Math.min(2,(1 + (strikes / 4))))
        if (striketimer > 0) {
            striketimer = striketimer - 17
            document.getElementById("clock").style.color = "#f00"
        }
        else document.getElementById("clock").style.color = "#0ff"
        if (ms >= 1000) {
            ss++
            ms = ms - 1000
            if (ss >= 60) {
                mm++
                ss = ss - 60
            }
        }
        mmdisp = (mm < 10) ? "0" + mm : mm
        ssdisp = (ss < 10) ? "0" + ss : ss
        msdisp0 = (ms < 100) ? (ms < 10) ? "00" + ms : "0" + ms : ms
        msdisp = ("" + msdisp0).slice(0,2)
        if (mm >= 1) time = mmdisp + ":" + ssdisp
        else time = ssdisp + "." + msdisp
        document.getElementById("clock").innerText = time
        var t = setTimeout(function(){currentTime()},17)
    }
    else {
        if (("" + msdisp0).length == 5) msdisp0 = msdisp0 * 10
        else if (("" + msdisp0).length == 6) msdisp0 = msdisp0 * 100
        if (mm >= 1) time = mmdisp + ":" + ssdisp + "." + msdisp0
        else time = ssdisp + "." + msdisp0
        document.getElementById("clock").innerText = time
    }
}
currentTime()
</script>
